<html>
<head>
<title>model_development.ipynb</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #8c8c8c; font-style: italic;}
.s1 { color: #080808;}
.s2 { color: #0033b3;}
.s3 { color: #067d17;}
.s4 { color: #1750eb;}
.s5 { color: #0037a6;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
model_development.ipynb</font>
</center></td></tr></table>
<pre><span class="s0">#%% md 
</span><span class="s1"># Model development 
 
Apply the model for small instances (e.g. 6 facilities, and 10 oil spills in Hudson)++ 
 
Outline of this script: 
1. Input data 
2. Optimization Model 
3. Output in a form of Network Diagram 
</span><span class="s0">#%% md 
</span><span class="s1"># Data 
</span><span class="s0">#%% 
# import custom functions</span>
<span class="s2">import </span><span class="s1">data_preparation</span>
<span class="s2">import </span><span class="s1">custom_func</span>
<span class="s2">import </span><span class="s1">model, model2</span>
<span class="s2">import </span><span class="s1">model_analysis</span>
<span class="s0"># import libraries</span>
<span class="s2">import </span><span class="s1">pandas </span><span class="s2">as </span><span class="s1">pd</span>
<span class="s2">import </span><span class="s1">geopandas </span><span class="s2">as </span><span class="s1">gpd</span>
<span class="s0">#%% 
# Import data</span>
<span class="s1">spill_data = pd.read_excel(</span><span class="s3">'Inputs/data_oil_spill_resource_allocation_Arctic_2023.xlsx'</span><span class="s1">, sheet_name=</span><span class="s3">'spills'</span><span class="s1">, header=</span><span class="s4">0</span><span class="s1">).copy()</span>
<span class="s0"># spill_data = spill_data.sample(n=100)</span>
<span class="s1">station_data = pd.read_excel(</span><span class="s3">'Inputs/data_oil_spill_resource_allocation_Arctic_2023.xlsx'</span><span class="s1">, sheet_name=</span><span class="s3">'stations'</span><span class="s1">, header=</span><span class="s4">0</span><span class="s1">).copy()</span>
<span class="s0">#station_data = station_data.iloc[[7,9,10, 13,15,16, 18]] # for small scale problem, we select stations nearby Hudson Bay &amp; Strait</span>
<span class="s1">input_parameters = pd.read_excel(</span><span class="s3">'Inputs/data_oil_spill_resource_allocation_Arctic_2023.xlsx'</span><span class="s1">, sheet_name=</span><span class="s3">'Estimated parameters'</span><span class="s1">, header=</span><span class="s4">0</span><span class="s1">).copy()</span>
<span class="s1">sensitivity_dataR = gpd.read_file(</span><span class="s3">'Inputs/ArcGIS_data/Sensitivity_data/Sensitivity_data5.shp'</span><span class="s1">).copy()</span>
<span class="s0">#%% 
# spill_data.to_excel('Inputs/data_100_oil_spills.xlsx', sheet_name='spills')</span>
<span class="s1">spill_data = pd.read_excel(</span><span class="s3">'Inputs/data_100_oil_spills.xlsx'</span><span class="s1">, sheet_name=</span><span class="s3">'spills'</span><span class="s1">, header=</span><span class="s4">0</span><span class="s1">).copy()</span>

<span class="s0">#%% 
</span><span class="s1">display(spill_data)</span>
<span class="s1">display(station_data)</span>
<span class="s0">#%% md 
</span><span class="s1">## Input parameters 
</span><span class="s0">#%% 
# %% One value</span>
<span class="s1">NumberStMax =</span><span class="s4">5</span>
<span class="s1">DistanceMax = </span><span class="s4">200 </span><span class="s0"># (DistanceMax*80)km  convert it to kilometer, typical speed 20km/hr -&gt; 480km/day</span>
<span class="s1">TimeRMax = </span><span class="s4">220  </span><span class="s0"># covert it into hours or minutes</span>


<span class="s0">#%% 
</span><span class="s1">current_vs_proposed = </span><span class="s3">'proposed' </span><span class="s0"># current</span>
<span class="s0">#%% 
# </span>
<span class="s1">Stations, OilSpills, ResourcesD, Demand, Availability, Eff, Distance, TimeR, Cf_s, Cu_sor \</span>
<span class="s1">= data_preparation.generate_input_data(station_data, spill_data, input_parameters)</span>
<span class="s1">coordinates_spill = custom_func.extract_spill_coordinate(spill_data)</span>
<span class="s1">coordinates_st = custom_func.extract_station_coordinate(station_data)</span>
<span class="s0">#%% 
</span><span class="s1">max(Distance.values())</span>
<span class="s0">#%% 
</span><span class="s1">print(</span><span class="s3">'coordinates_st'</span><span class="s1">)</span>
<span class="s1">display(coordinates_st)</span>

<span class="s1">print(</span><span class="s3">'Demand'</span><span class="s1">)</span>
<span class="s1">display(Demand)</span>
<span class="s1">print(</span><span class="s3">'Availability'</span><span class="s1">)</span>
<span class="s1">display(Availability)</span>
<span class="s1">print(</span><span class="s3">'Eff'</span><span class="s1">)</span>
<span class="s1">display(Eff)</span>

<span class="s1">print(</span><span class="s3">'Distance'</span><span class="s1">)</span>
<span class="s1">display(Distance)</span>

<span class="s1">print(</span><span class="s3">'TimeR'</span><span class="s1">)</span>
<span class="s1">display(TimeR)</span>

<span class="s1">print(</span><span class="s3">'Cf_s'</span><span class="s1">); display(Cf_s)</span>
<span class="s1">print(</span><span class="s3">'Cu_sor'</span><span class="s1">)</span>
<span class="s1">display(Cu_sor)</span>
<span class="s0">#%% 
</span><span class="s1">OilSpills</span>
<span class="s0">#%% 
#max(Distance.values())</span>
<span class="s1">SizeSpill = SizeSpill_R = list(spill_data[</span><span class="s3">'Spill size'</span><span class="s1">]).copy()</span>
<span class="s1">Sensitivity_R = custom_func.calculate_sensitivity(coordinates_spill[</span><span class="s4">0</span><span class="s1">], sensitivity_dataR)</span>
<span class="s0"># normalize</span>
<span class="s1">SizeSpill_n = dict(zip(OilSpills, custom_func.normalize(SizeSpill_R, min(SizeSpill_R), max(SizeSpill_R))))</span>
<span class="s1">Sensitivity_n = dict(zip(OilSpills, custom_func.normalize(Sensitivity_R, min(Sensitivity_R), max(Sensitivity_R))))</span>

<span class="s1">Distance_n = dict(zip(Distance.keys(), custom_func.normalize(Distance.values(), min(Distance.values()), max(Distance.values()))))</span>
<span class="s0"># (x_0-x_min)/(x_max-x_min) </span>
<span class="s1">Effectiveness_n = dict(zip(Eff.keys(), custom_func.normalize(Eff.values(), min(Eff.values()), max(Eff.values()))))</span>
<span class="s0">#%% 
</span><span class="s1">Demand</span>
<span class="s0">#%% 
</span>
<span class="s0">#%% md 
</span><span class="s1"># Model Configuration 1 
## Table 3 (Row 1) 
</span><span class="s0">#%% 
</span>
<span class="s0">#%% raw 
</span><span class="s1">import gurobipy as gp 
from gurobipy import GRB 
from datetime import datetime, date 
 
# Decision variable 
os_pair = {(o, s): custom_func.compute_distance(coordinates_spill[1][o], coordinates_st[1][s]) 
           for o in OilSpills 
           for s in Stations 
           if 
           custom_func.compute_distance(tuple(coordinates_spill[1][o]), tuple(coordinates_st[1][s])) &lt; DistanceMax} 
# coordinates_spill[1][o] [1] access 2nd element of tuple coordinate_spill 
os_pair = tuple(os_pair.keys()) 
 
# sr_pair (based on unique statoins in pair_os ) 
st_o = list(set([item[1] for item in os_pair]))  # .unique() 
sr_pair = [] 
for s in st_o: 
    for r in ResourcesD: 
        sr_pair.append((s, r)) 
sr_pair = tuple(sr_pair) 
 
o_s = list(set([item[0] for item in os_pair]))  # .unique() 
or_pair = [] 
for o in o_s: 
    for r in ResourcesD: 
        or_pair.append((o, r)) 
or_pair = tuple(or_pair) 
 
&quot;&quot;&quot; 
osr_pair = [] 
for o in OilSpills: 
    for s in Stations: 
        if custom_func.compute_distance(tuple(coordinates_spill[1][o]), tuple(coordinates_st[1][s])) &lt; DistanceMax: 
            for r in ResourcesD: 
                osr_pair.append([o, s, r]) 
osr_pair = tuple(osr_pair) 
&quot;&quot;&quot; 
osr_pair = {(o, s, r): custom_func.compute_distance(coordinates_spill[1][o], coordinates_st[1][s]) 
            for o in OilSpills 
            for s in Stations 
            for r in ResourcesD 
            if 
            custom_func.compute_distance(tuple(coordinates_spill[1][o]), tuple(coordinates_st[1][s])) &lt; DistanceMax} 
# coordinates_spill[1][o] [1] access 2nd element of tuple coordinate_spill 
osr_pair = tuple(osr_pair.keys()) 
 
print('--------------MIP-moo--------') 
model = gp.Model(&quot;MIP-moo&quot;) 
# Decision variable 
cover = model.addVars(os_pair, vtype=GRB.BINARY, name='cover')  # OilSpills,  +++ 
# percentage of each spill covered (then, this individual percentage can be summed. 
select = model.addVars(st_o, ResourcesD, vtype=GRB.BINARY, name='select') 
deploy = model.addVars(osr_pair, vtype=GRB.CONTINUOUS, lb=0, name='deploy') 
# Availability = 10000  # ++ 
# Constraints 
C_open_facility = model.addConstrs((deploy[o, s, r] &lt;= Availability[s, r] * select[s, r] 
                                    for o, s, r in osr_pair), 
                                   name='C_open_facility') 
C_max_facility = model.addConstr((gp.quicksum(select[s, r] 
                                              for s, r in sr_pair) == NumberStMax), 
                                 name='C_max_facility')  # +++ 
C_deploy_demand = model.addConstrs((deploy[o, s, r] &lt;= Demand[o, r] 
                                    for o, s, r in osr_pair), 
                                   name='C_deploy_demand') 
&quot;&quot;&quot; 
C_deploy_demand = model.addConstrs((gp.quicksum(deploy[o, s, r] for s in Stations) 
                                    &lt;= Demand[o, r] for o in OilSpills for r in ResourcesD 
                                    if custom_func.compute_distance(tuple(coordinates_spill[1][o]), tuple(coordinates_st[1][s])) &lt; DistanceMax), 
                                   name='C_deploy_demand') 
 
 
C_facility_to_each_spill = model.addConstrs((gp.quicksum(cover[o, s]  for s in Stations) == 1 
                                            for o in OilSpills 
                                            if custom_func.compute_distance(tuple(coordinates_spill[1][o]), tuple(coordinates_st[1][s])) &lt; DistanceMax) 
                                            , name='C_facility_to_each_spill') 
&quot;&quot;&quot; 
C_facility_to_each_spill2 = model.addConstrs((cover.sum(o,'*')  == 1 
                                            for o in OilSpills) 
                                            , name='C_facility_to_each_spill') 
 
# %% Objective function 
model.ModelSense = GRB.MINIMIZE 
objective_1_re = gp.quicksum((SizeSpill_n[o] + Sensitivity_n[o] - Distance_n[o, s]) * cover[o, s] 
                             for o, s in os_pair) \ 
                 + gp.quicksum(Effectiveness_n[s, r] * deploy[o, s, r] 
                               for o, s, r in osr_pair) 
 
objective_2_cost = gp.quicksum(select[s, r] * Cf_s[s] for s, r in sr_pair) 
 
model.setObjectiveN(objective_1_re, index=0, priority=3, weight=-1, name='objective_re_1')  # weight=1 
# model.setObjectiveN(obj2_time, index=0, priority=2, weight=1, name='objective_1_time')  # weight=1 
model.setObjectiveN(objective_2_cost, index=1, priority=1, weight=1, name='objective_cost_2') 
 
model.optimize() 
</span><span class="s0">#%% 
</span>
<span class="s0">#%% 
</span>
<span class="s0">#%% 
</span>
<span class="s0">#%% 
</span>
<span class="s0">#%% 
</span>
<span class="s0">#%% 
</span><span class="s1">model, select, deploy, mvars, names, values, \</span>
        <span class="s1">spill_df, station_df, select_1s, deploy_1s, ResponseTimeT, coverage_percentage, assignment  \</span>
    <span class="s1">= model2.solve(Stations, OilSpills, ResourcesD, coordinates_st, coordinates_spill, SizeSpill, SizeSpill_n, \</span>
          <span class="s1">Demand, Sensitivity_R, Sensitivity_n, Eff, Effectiveness_n, Availability, NumberStMax, Distance, Distance_n, DistanceMax,  Cf_s, Cu_sor)</span>
<span class="s0">#%% 
</span><span class="s1">assignment</span>
<span class="s0">#%% 
#display(assignment.loc[assignment['Spill #'] == 'o47'])</span>
<span class="s0">#display(min(assignment.loc[assignment['Spill #'] == 'o47']['Distance']))</span>
<span class="s0">#%% 
</span><span class="s2">import </span><span class="s1">numpy </span><span class="s2">as </span><span class="s1">np</span>
<span class="s1">print(np.where(assignment[</span><span class="s3">'Distance'</span><span class="s1">] == </span><span class="s4">2.651846197637919</span><span class="s1">)[</span><span class="s4">0</span><span class="s1">])</span>

<span class="s0"># call a df based on index</span>
<span class="s1">assignment.iloc[np.where(assignment[</span><span class="s3">'Distance'</span><span class="s1">] == </span><span class="s4">2.651846197637919</span><span class="s1">)[</span><span class="s4">0</span><span class="s1">]]</span>
<span class="s1">assignment.columns</span>
<span class="s0">#%% 
</span><span class="s1">assignment_df = pd.DataFrame(columns=list(assignment.columns.values))</span>
<span class="s2">for </span><span class="s1">i,o </span><span class="s2">in </span><span class="s1">enumerate(assignment[</span><span class="s3">'Spill #'</span><span class="s1">].unique()):</span>
    <span class="s1">minD = min(assignment.loc[assignment[</span><span class="s3">'Spill #'</span><span class="s1">] == o][</span><span class="s3">'Distance'</span><span class="s1">])</span>
    <span class="s1">df = assignment.iloc[np.where(assignment[</span><span class="s3">'Distance'</span><span class="s1">] == minD)[</span><span class="s4">0</span><span class="s1">]]</span>
    <span class="s1">assignment_df = pd.concat([assignment_df, df])</span>
<span class="s1">assignment_df</span>
<span class="s0">#%% 
</span><span class="s1">assignment.iloc[np.where(assignment[</span><span class="s3">'Distance'</span><span class="s1">] == minD)[</span><span class="s4">0</span><span class="s1">]]</span>
<span class="s0">#%% 
</span><span class="s1">print(</span><span class="s3">'Sensitivity_n'</span><span class="s1">)</span>
<span class="s1">display(Sensitivity_n)</span>

<span class="s1">print(</span><span class="s3">'Spill_df'</span><span class="s1">)</span>
<span class="s1">display(spill_df)</span>
<span class="s1">print(</span><span class="s3">'[item for item in deploy_1s.index]'</span><span class="s1">)</span>
<span class="s1">display([item </span><span class="s2">for </span><span class="s1">item </span><span class="s2">in </span><span class="s1">deploy_1s.index])</span>
<span class="s1">print(</span><span class="s3">'deploy_1s'</span><span class="s1">)</span>
<span class="s1">display(deploy_1s)</span>
<span class="s1">print(</span><span class="s3">'deploy_1s.index'</span><span class="s1">)</span>
<span class="s1">display(deploy_1s.index)</span>
<span class="s0">#%% md 
</span><span class="s1">## Fig5a Network Diagram with 4 stations inc. Hay River as hub 
</span><span class="s0">#%% 
</span><span class="s1">model_analysis.draw_network_diagram(DistanceMax, NumberStMax, Sensitivity_R, spill_df, station_df, ResponseTimeT, coverage_percentage,</span>
                         <span class="s1">assignment, deploy_1s, select_1s, current_vs_proposed)</span>
<span class="s0">#%% md 
</span><span class="s1">## Table 4: Resource deployment from facilities 
</span><span class="s0">#%% 
</span>
<span class="s1">selected_st_name = list(select_1s.reset_index().level_0)</span>
<span class="s1">selected_st_name</span>
<span class="s0">#%% 
</span><span class="s1">deploy_1s</span>
<span class="s0">#%% 
</span><span class="s1">deploy_df = pd.DataFrame(deploy_1s.reset_index())</span>
<span class="s1">deploy_df</span>
<span class="s0">#deploy_df.columns = ['St', 'os', 'rr','amount']</span>
<span class="s0">#print(deploy_df.columns)</span>
<span class="s0">#%% 
</span><span class="s1">max(Distance_n.values())</span>
<span class="s0">#%% 
</span><span class="s1">selected_st_name.index</span>
<span class="s0">#%% 
</span><span class="s1">resource_deployment_from_facility = pd.DataFrame(columns=[</span><span class="s3">'M'</span><span class="s1">,</span><span class="s3">'C'</span><span class="s1">,</span><span class="s3">'I'</span><span class="s1">])</span>
<span class="s2">for </span><span class="s1">index, st </span><span class="s2">in </span><span class="s1">enumerate(selected_st_name):</span>
    <span class="s1">a = deploy_df.loc[(deploy_df[</span><span class="s3">'level_0'</span><span class="s1">] == st) &amp; (deploy_df[</span><span class="s3">'level_2'</span><span class="s1">] == </span><span class="s3">'m'</span><span class="s1">), </span><span class="s4">0</span><span class="s1">].sum()</span>
    <span class="s1">b = deploy_df.loc[(deploy_df[</span><span class="s3">'level_0'</span><span class="s1">] == st) &amp; (deploy_df[</span><span class="s3">'level_2'</span><span class="s1">] == </span><span class="s3">'c'</span><span class="s1">), </span><span class="s4">0</span><span class="s1">].sum()</span>
    <span class="s1">c = deploy_df.loc[(deploy_df[</span><span class="s3">'level_0'</span><span class="s1">] == st) &amp; (deploy_df[</span><span class="s3">'level_2'</span><span class="s1">] == </span><span class="s3">'i'</span><span class="s1">), </span><span class="s4">0</span><span class="s1">].sum()</span>
    <span class="s1">resource_deployment_from_facility.loc[index] = [a,b,c]</span>
    
<span class="s1">resource_deployment_from_facility.index=selected_st_name</span>
<span class="s1">resource_deployment_from_facility</span>
<span class="s0">#%% 
</span>
<span class="s0">#%% md 
</span>
<span class="s0">#%% 
#deploy_1s</span>
<span class="s1">sum(Distance.values()) / len(Distance)</span>
<span class="s1">max(Distance.values())</span>
<span class="s0">#%% 
</span><span class="s1">display(select_1s)</span>
<span class="s0">#display(station_df[station_df['Station no.'].isin(select_1s.reset_index().level_0)])</span>
<span class="s1">display(spill_df)</span>
<span class="s0">#%% 
</span><span class="s1">selected_supply_stations = list(deploy_1s.reset_index().level_1.unique())</span>
<span class="s1">len(selected_supply_stations)</span><span class="s0">#.shape[0]</span>
<span class="s1">data_st_selected = station_df[station_df[</span><span class="s3">'Station no.'</span><span class="s1">].isin(select_1s.reset_index().level_0)].reset_index()</span>
<span class="s2">import </span><span class="s1">matplotlib.pyplot </span><span class="s2">as </span><span class="s1">plt</span>
<span class="s0">#%% 
#data_st_selected.loc[:, 'Station no.'][i] #+ 1</span>
<span class="s0">#%% 
# Input param</span>
<span class="s1">Stations, OilSpills, ResourcesD, Demand, Availability, Eff, Distance, TimeR, Cf_s, Cu_sor \</span>
<span class="s1">= data_preparation.generate_input_data(potential_station_data, spill_data, input_parameters)</span>
<span class="s1">SizeSpill = SizeSpill_R = list(spill_data[</span><span class="s3">'Spill size'</span><span class="s1">]).copy()</span>
<span class="s1">Sensitivity_R = custom_func.calculate_sensitivity(coordinates_spill[</span><span class="s4">0</span><span class="s1">], sensitivity_dataR)</span>
<span class="s0"># normalize</span>
<span class="s1">SizeSpill_n = dict(zip(OilSpills, custom_func.normalize(SizeSpill_R, min(SizeSpill_R), max(SizeSpill_R))))</span>
<span class="s1">Sensitivity_n = dict(zip(OilSpills, custom_func.normalize(Sensitivity_R, min(Sensitivity_R), max(Sensitivity_R))))</span>
<span class="s1">Distance_n = dict(zip(Distance.keys(), custom_func.normalize(Distance.values(), min(Distance.values()), max(Distance.values()))))</span>
<span class="s0"># (x_0-x_min)/(x_max-x_min)</span>
<span class="s1">Effectiveness_n = dict(zip(Eff.keys(), custom_func.normalize(Eff.values(), min(Eff.values()), max(Eff.values()))))</span>

<span class="s0"># Model</span>
<span class="s1">model, select, deploy, mvars, names, values, \</span>
        <span class="s1">spill_df, station_df, select_1s, deploy_1s, ResponseTimeT, coverage_percentage, assignment  \</span>
    <span class="s1">= model2.solve(Stations, OilSpills, ResourcesD, coordinates_st, coordinates_spill, SizeSpill, SizeSpill_n, \</span>
          <span class="s1">Demand, Sensitivity_R, Sensitivity_n, Eff, Effectiveness_n, Availability, NumberStMax, Distance, Distance_n, DistanceMax,  Cf_s, Cu_sor)</span>

<span class="s0"># Draw the network</span>
<span class="s1">model_analysis.draw_network_diagram(DistanceMax, NumberStMax, Sensitivity_R, spill_df, station_df, ResponseTimeT, coverage_percentage,</span>
                         <span class="s1">assignment, deploy_1s, select_1s)</span>
<span class="s0">#%% 
</span>
<span class="s0">#%% 
#import model_analysis</span>
<span class="s0">#%% 
</span><span class="s1">model_analysis.draw_network_diagram(DistanceMax, NumberStMax, Sensitivity_R, spill_df, station_df, ResponseTimeT, coverage_percentage,</span>
                         <span class="s1">assignment, deploy_1s, select_1s)</span>
<span class="s0">#%% 
</span><span class="s2">import </span><span class="s1">pandas </span><span class="s2">as </span><span class="s1">pd</span>
<span class="s1">df = pd.DataFrame()</span>
<span class="s0">#df['ll'] = list([2,10])</span>
<span class="s0">#df.loc[1]</span>
<span class="s0">#%% 
</span><span class="s1">df</span>
<span class="s0">#%% 
</span><span class="s1">assignment.columns</span>
<span class="s0">#%% 
</span><span class="s1">assignment</span>
<span class="s0">#%% 
</span><span class="s1">display(assignment)</span>
<span class="s1">display(deploy_1s)</span>
<span class="s0">#%% 
</span><span class="s1">deploy_reset = deploy_1s.reset_index()</span>
<span class="s1">deploy_reset.columns = [</span><span class="s3">'Station no.'</span><span class="s1">, </span><span class="s3">'Spill #'</span><span class="s1">, </span><span class="s3">'Resource Type'</span><span class="s1">, </span><span class="s3">'Quantity deployed'</span><span class="s1">]</span>
<span class="s0">#%% 
</span><span class="s1">display(assignment)</span>
<span class="s0">#%% 
</span><span class="s2">from </span><span class="s1">matplotlib </span><span class="s2">import </span><span class="s1">collections </span><span class="s2">as </span><span class="s1">mc</span>
<span class="s2">import </span><span class="s1">matplotlib.pyplot </span><span class="s2">as </span><span class="s1">plt</span>
<span class="s1">unique_stations = assignment[</span><span class="s3">'Station no.'</span><span class="s1">].unique()</span>

<span class="s1">fig, ax = plt.subplots()</span>
<span class="s1">ArcticMap = gpd.read_file(</span><span class="s3">&quot;Inputs/ArcGIS_data/ArcticShapefile2/ArcticShapefile2.shp&quot;</span><span class="s1">)</span>
<span class="s1">ArcticMap = ArcticMap.to_crs(epsg=</span><span class="s4">4326</span><span class="s1">)  </span><span class="s0"># 3857</span>
<span class="s1">ArcticLand = ArcticMap[ArcticMap[</span><span class="s3">'Region_EN'</span><span class="s1">].isin([</span><span class="s3">'Arctic'</span><span class="s1">])]</span>
<span class="s1">ArcticLand.plot(ax=ax, color=</span><span class="s3">&quot;seashell&quot;</span><span class="s1">)</span>

<span class="s2">for </span><span class="s1">ust </span><span class="s2">in </span><span class="s1">range(len(unique_stations)):</span>
    <span class="s1">d1 = assignment.loc[assignment[</span><span class="s3">'Station no.'</span><span class="s1">] == unique_stations[ust]].reset_index()</span>
    <span class="s1">d_m = pd.DataFrame(d1.loc[d1[</span><span class="s3">'Resource Type'</span><span class="s1">] == </span><span class="s3">'m'</span><span class="s1">].copy())</span>
    <span class="s1">d_c = d1.loc[d1[</span><span class="s3">'Resource Type'</span><span class="s1">] == </span><span class="s3">'c'</span><span class="s1">].copy()</span>
    <span class="s1">d_i = d1.loc[d1[</span><span class="s3">'Resource Type'</span><span class="s1">] == </span><span class="s3">'i'</span><span class="s1">].copy()</span>

    <span class="s1">new_list_m = []</span>
    <span class="s2">for </span><span class="s1">r1 </span><span class="s2">in </span><span class="s1">range(d_m.shape[</span><span class="s4">0</span><span class="s1">]):</span>
        <span class="s1">new_list_m.append([(d_m.loc[r1, </span><span class="s3">'Spill_Longitude'</span><span class="s1">], d_m.loc[r1, </span><span class="s3">'Spill_Latitude'</span><span class="s1">]), (d_m.loc[r1, </span><span class="s3">'St_Longitude'</span><span class="s1">], d_m.loc[r1, </span><span class="s3">'St_Latitude'</span><span class="s1">])])</span>
        <span class="s0"># d_m.loc[2, 'Spill_Longitude']</span>
        <span class="s0"># new_list_m.append([(d_m.Spill_Longitude[r1], d_m.Spill_Latitude[r1]), (d_m.St_Longitude[r1], d_m.St_Latitude[r1])])</span>
        <span class="s1">lc_m = mc.LineCollection(new_list_m, colors=</span><span class="s3">f'C</span><span class="s5">{</span><span class="s1">ust + </span><span class="s4">1</span><span class="s5">}</span><span class="s3">'</span><span class="s1">,</span>
                           <span class="s1">alpha=</span><span class="s4">.7</span><span class="s1">, linestyle=</span><span class="s3">'dashed'</span><span class="s1">)  </span><span class="s0"># 'Resource Type' alpha = (ust/len(unique_stations)), colors=ust, linewidths=[1,5,10],</span>
    <span class="s1">ax.add_collection(lc_m)</span>
<span class="s0">#%% 
</span><span class="s1">d_m.loc[</span><span class="s4">2</span><span class="s1">, </span><span class="s3">'Spill_Longitude'</span><span class="s1">]</span>
<span class="s0">#%% 
</span><span class="s1">d_m.Spill_Longitude[</span><span class="s4">0</span><span class="s1">]</span>
<span class="s0">#%% 
</span>
<span class="s0">#%% 
</span><span class="s1">print(d_m.shape)</span>
<span class="s1">print(d1.shape) </span><span class="s0">#.Spill_Longitude[1]</span>
<span class="s1">print(d_m.shape[</span><span class="s4">0</span><span class="s1">])</span>
<span class="s1">display(d1)</span>
<span class="s1">display(d_m)</span>
<span class="s0">#%% 
</span><span class="s1">d_m</span>
<span class="s0">#df.loc[df['col1'] == value]</span>
<span class="s0">#%% 
</span><span class="s1">assignment.loc[assignment[</span><span class="s3">'Station no.'</span><span class="s1">] == unique_stations[ust]].reset_index()</span>
<span class="s0">#%% md 
</span><span class="s1"># Model Configuration 2 
</span><span class="s0">#%% md 
</span><span class="s1">## Fig5b 
</span><span class="s0">#%% 
</span>
<span class="s0">#%% md 
</span><span class="s1"># Pareto Front 
 
</span><span class="s0">#%% 
</span>
<span class="s0">#%% 
</span><span class="s2">import </span><span class="s1">pandas </span><span class="s2">as </span><span class="s1">pd</span>
<span class="s2">import </span><span class="s1">seaborn </span><span class="s2">as </span><span class="s1">sns</span>
<span class="s2">import </span><span class="s1">matplotlib.pyplot </span><span class="s2">as </span><span class="s1">plt</span>
<span class="s0">#%% 
</span><span class="s1">data_pareto_front = pd.read_excel(</span><span class="s3">'Outputs/pareto front.xlsx'</span><span class="s1">, sheet_name=</span><span class="s3">'pareto front2'</span><span class="s1">)</span>
<span class="s1">data_pareto_front</span>
<span class="s0">#%% 
</span><span class="s1">plt.figure(figsize=(</span><span class="s4">6</span><span class="s1">,</span><span class="s4">4</span><span class="s1">))</span>
<span class="s1">plt.scatter(data=data_pareto_front, x=</span><span class="s3">'Max Coverage'</span><span class="s1">, y=</span><span class="s3">'Min Cost'</span><span class="s1">,</span>
            <span class="s1">alpha=</span><span class="s4">0.5</span><span class="s1">, edgecolors=</span><span class="s3">'b'</span><span class="s1">, s=</span><span class="s4">200</span><span class="s1">, color=</span><span class="s3">'g'</span><span class="s1">)</span>
<span class="s1">plt.xlabel(</span><span class="s3">'Max Coverage'</span><span class="s1">)</span>
<span class="s1">plt.ylabel(</span><span class="s3">'Min Cost'</span><span class="s1">)</span>
<span class="s1">plt.grid(</span><span class="s2">False</span><span class="s1">)</span>
<span class="s1">plt.tight_layout()</span>
<span class="s1">plt.savefig(</span><span class="s3">'Outputs/pareto_front.png'</span><span class="s1">, transparent=</span><span class="s2">True</span><span class="s1">)</span>
<span class="s0">#%% md 
</span>
<span class="s0">#%% 
</span><span class="s1">plt.figure(figsize=(</span><span class="s4">6</span><span class="s1">,</span><span class="s4">4</span><span class="s1">))</span>
<span class="s1">plt.scatter(data=data_pareto_front, x=</span><span class="s3">'Max Coverage'</span><span class="s1">, y=</span><span class="s3">'Min Cost'</span><span class="s1">,</span>
            <span class="s1">alpha=</span><span class="s4">0.5</span><span class="s1">, edgecolors=</span><span class="s3">'b'</span><span class="s1">, s=</span><span class="s4">200</span><span class="s1">, color=</span><span class="s3">'g'</span><span class="s1">)</span>
<span class="s1">plt.scatter(data=data_pareto_front, x=</span><span class="s3">'Max'</span><span class="s1">, y=</span><span class="s3">'Min'</span><span class="s1">,</span>
            <span class="s1">alpha=</span><span class="s4">0.5</span><span class="s1">, edgecolors=</span><span class="s3">'black'</span><span class="s1">, s=</span><span class="s4">200</span><span class="s1">, color=</span><span class="s3">'r'</span><span class="s1">)</span>
<span class="s1">Max = data_pareto_front[[</span><span class="s3">'Max'</span><span class="s1">]]</span>
<span class="s1">Min = data_pareto_front[[</span><span class="s3">'Min'</span><span class="s1">]]</span>
<span class="s1">plt.plot(Max, Min,</span>
            <span class="s1">ls=</span><span class="s3">'--'</span><span class="s1">, alpha=</span><span class="s4">0.5</span><span class="s1">, color=</span><span class="s3">'r'</span><span class="s1">)</span>
<span class="s1">plt.xlabel(</span><span class="s3">'Max Coverage'</span><span class="s1">)</span>
<span class="s1">plt.ylabel(</span><span class="s3">'Min Cost'</span><span class="s1">)</span>
<span class="s1">plt.grid(</span><span class="s2">False</span><span class="s1">)</span>
<span class="s1">plt.tight_layout()</span>
<span class="s0">#plt.axis('off')</span>
<span class="s1">plt.savefig(</span><span class="s3">'Outputs/pareto_frontier_points.png'</span><span class="s1">, transparent=</span><span class="s2">True</span><span class="s1">)</span>
<span class="s0">#%% 
</span></pre>
</body>
</html>